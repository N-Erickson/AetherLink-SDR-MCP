name: Sanity Checks

# What this CI tests:
# - Code imports without errors
# - Server initializes properly
# - DSP algorithms don't regress
# - Tools are registered correctly
#
# What this CI does NOT test:
# - Real SDR hardware (no USB devices on runners)
# - Actual RF signal reception (no antennas in data centers)
# - Decoder performance with real signals
#
# For real-world validation, see tests/manual/ and run locally with hardware

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  test:
    runs-on: ubuntu-latest
    timeout-minutes: 5

    steps:
    - uses: actions/checkout@v4

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: "3.11"

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -e .
        pip install pytest pytest-asyncio

    - name: Run sanity checks
      run: |
        pytest tests/test_sanity.py -v --tb=short

    - name: Quick smoke test
      run: |
        python -c "from sdr_mcp.server import SDRMCPServer; s = SDRMCPServer(); print(f'âœ… Server initialized with {len(s.server.list_tools())} tools')"
